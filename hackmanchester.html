<head>
  <title>hackmanchester</title>
</head>

<template name="layout">
    {{> navigation }}
    {{> yield}}
</template>

<template name="navigation">
    <div class="ui inverted menu">    
        <li class="item">{{> loginButtons}}</li>
        <a class="item {{isActive 'home'}}" href="{{pathFor route='home'}}">Home</a>
        <a class="item {{isActive 'hacks'}}" href="{{pathFor route='hacks'}}">All Hacks</a>
        {{#unless isJudge}}
        {{#unless isAdmin}}
        {{#if currentUser}}
        <a class="item {{isActive 'myhacks'}}" href="{{pathFor route='myhacks'}}">Team Hacks</a>
        {{/if}}
        {{/unless}}
        {{/unless}}
        <a class="item {{isActive 'teams'}}" href="{{pathFor route='teams'}}">Teams</a>
        {{#unless isJudge}}
        {{#unless isAdmin}}
        {{#if currentUser}}
        <a class="item {{isActive 'myteam'}}" href="{{pathFor route='myteam'}}">My Team</a>
        {{/if}}
        {{/unless}}
        {{/unless}}
        <div class="right menu">
            {{#if isJudge}}
                <a class="item {{isActive 'judging'}}" href="{{pathFor route='judging'}}">Judging</a>
            {{/if}}
            {{#if isAdmin}}
                <a class="item {{isActive 'administration'}}" href="{{pathFor route='administration'}}">Admin</a>
            {{/if}}
        </div>
    </div>
    <div class="header group">
        <h1 id="logo"><a href="#"><img src="/images/logo.png" alt="HAC 1: Hack Manchester 2015" width="50%"></a></h1>
        <h2 class="date"><img src="/images/date.png" alt="24th &dash; 25th October 2015" width="50%"/></h2>
    </div>
</template>

<template name="home">
    <div class="ui raised padded text container segment">
        <h2 class="ui header">Latest submissions:</h2>
    </div>
    <div class="ui container">
        <div class="ui three cards">
        {{#each hacks}}
            {{> hackoverview }}
        {{/each}}
        </div>
    </div>
</template>

<template name="showhacks">
    <div class="ui container">
        <div class="ui three cards">
        {{#each hacks}}
                {{> hackoverview }}
        {{/each}}
        </div>
    </div>
    {{#unless isJudge}}
    {{#unless isAdmin}}
        <div class="ui raised very padded text container segment">
            <h2>Want to submit a new hack?</h2>
            {{#unless currentUser}}
                You are not currently logged in!
            {{/unless}}
            {{#if currentUser}}
                {{#unless currentUser/profile/team}}
                    You are not in a team yet!
                {{/unless}}
                {{#if currentUser/profile/team}}
                    <form class="new-hack">
                        {{> entry }}
                    </form>
                {{/if}}
            {{/if}}
        </div>
    {{/unless}}
    {{/unless}}
</template>

<template name="allhacks">
    <div class="ui raised very padded text container segment">
        <h1>Hacks!</h1>
        <p>How are you and your competition doing?</p>
    </div>
    {{> showhacks .. }}
</template>

<template name="myhacks">
    <div class="ui raised very padded text container segment">
        <h1>Your teams Hacks!</h1>
    </div>
    {{> showhacks .. }}
</template>

<template name="hackoverview">
    <div class="ui card">
        <div class="content">
            <div class="header">
                <i class="users icon"></i> {{name}} (team <a href="{{pathFor 'team' _id=team}}">{{teamname team}}</a>)
            </div>
            <div class="meta">
                <ul>
                    {{#each enteredChallenges}}
                        <li>{{description}}</li>
                    {{/each}}
                </ul>
            </div>
            <div class="description">
                {{trim250 description}}
            </div>
        </div>
        <div class="ui bottom attached button">
            {{#if myHack }}
                <a href="{{pathFor 'hack'}}">Edit</a>
            {{/if}}
            {{#unless myHack }}
                <a href="{{pathFor 'hack'}}">View</a>
            {{/unless}}
        </div>
    </div>
</template>

<template name="hack">
    <div class="ui raised very padded text container">
    {{#unless myHack}}
        <div class="ui segments">
            <div class="ui segment">
                <h1>{{name}}</h1>
            </div>
            <div class="ui secondary segment">
                <h2><i class="users icon"></i> {{teamname team}}</h2>
            </div>
            <div class="ui secondary segment">
                <p>{{description}}</p>
            </div>
            {{#if youtube}}
            <div class="ui secondary segment">
                <a href="{{youtube}}" target="_blank">View video entry</a>
            </div>
            {{/if}}
            {{#if hackurl}}
                <div class="ui secondary segment">
                    <a href="{{hackurl}}" target="_blank">View hack at {{hackurl}}</a>
                </div>
            {{/if}}
        </div>
    {{/unless}}
    {{#if myHack}}
        <form class="edit-hack">
            {{> entry }}
        </form>
    {{/if}}
    {{#if isJudge}}
        <div class="ui segments">
            <div class="ui segment">
                <h2>Judges comments:</h2>
            </div>
            {{#unless judgesComments}}
            <div class="ui segment secondary">
                <p>No comments have been made yet!</p>
            </div>
            {{/unless}}
            {{#each judgesComments}}
                <div class="ui segment">
                    <div class="ui segment">
                        {{created}} <strong>{{judge}}</strong>
                    </div>
                    <div class="ui inverted segment">
                        {{judgement}}
                    </div>
                </div>
            {{/each}}
            <div class="ui segment form">
                <form class="new-judgement">
                    <div class="field">
                        <label for="judgement">Add a judgment:</label>
                        <textarea type="text" name="judgement" placeholder="Add a judgment ..." value="{{judgement}}"></textarea>
                    </div>
                    <button class="primary ui button" type="submit">Submit</button>
                </form>
            </div>
        </div>
    {{/if}}
    </div>
</template>

<template name="entry">
    <div class="ui segment">
        <div class="ui form">
            <div class="field">
                <label for="name">Name:</label>
                <input type="text" name="name" placeholder="Hack name ..." value="{{name}}" />
            </div>
            {{#each myChallenges}}
            <div class="field">
                <div class="ui checkbox">
                    <input type="checkbox" name="challenges" checked={{entered}} value="{{_id}}" tabindex="0" />
                    <label>{{description}}</label>
                </div>
            </div>
            {{/each}}
            <div class="field">
                <label for="description">Description:</label>
                <textarea type="text" name="description" placeholder="Description ..." value="{{description}}"></textarea>
            </div>
            <div class="field">
                <label for="technologies">Technologies:</label>
                <select name="technologies" class="ui fluid search dropdown" multiple="">
                    <option value="">Tech</option>
                    {{#each myTechnologies}}
                        <option value="{{_id}}" selected={{selected}}>{{description}}</option>
                    {{/each}}
                </select>
                <div class="ui right labeled left icon input">
                    <i class="tags icon"></i>
                    <input type="text" name="tag" placeholder="Enter new tags here (you need to click: Add Tag) ...">
                    <a class="ui tag label" id="add-tag">
                        Add Tag
                    </a>
                </div>
            </div>
            <div class="field">
                <label for="description">Youtube URL:</label>
                <input type="text" name="youtube" placeholder="Youtube URL ..." value="{{youtube}}" />
            </div>
            <div class="field">
                <label for="description">Hack URL:</label>
                <input type="text" name="hackurl" placeholder="Hack URL ..." value="{{hackurl}}" />
            </div>
            <button class="ui positive button" type="submit">Save</button>
        </div>
    </div>
</template>

<template name="teams">
    <div class="ui segment">
        <h2 class="ui header">
            <i class="users icon"></i> 
            <div class="content">
                Teams
                <div class="sub header">Check out all the teams competing in HackManchester</div>
            </div>
        </h2>
    </div>
    <div class="ui container">
        <div class="ui three cards">
        {{#each teams}}
            {{> teamoverview }}
        {{/each}}
        </div>
    </div>
</template>

<template name="teamform">
    <div class="field">
        <label for="description">Team name:</label>
        <input type="text" name="name" placeholder="Team name" value="{{name}}" />
    </div>
    <div class="field">
        <label for="description">Table number:</label>
        <input type="text" name="table" placeholder="Table number ..." value="{{table}}" />
    </div>
    <div class="field">
        <button class="ui positive button" type="submit">Save</button>
    </div>
</template>

<template name="team">
    {{#if currentUser}}
    {{#unless name}}
        <div class="ui raised very padded text container">
            <div class="ui segment form">
                <h2>Want to create a team?</h2>
                <p>You don't currently belong to a team. Either create one here or find a team on the <a class="item" href="{{pathFor route='teams'}}">Teams</a> page.</p>
                <form class="add-team">
                    {{> teamform }}
                </form>
            </div>
        </div>
    {{/unless}}
    {{#if name}}
    <div class="ui raised very padded text container">
        <div class="ui segment">
            {{#if ismyteam _id}}
            <div class="ui segment form">
                <form class="edit-team">
                    {{> teamform }}
                </form>
            </div>
            {{/if}}
            {{#unless ismyteam _id}}
                <h2><i class="users icon"></i> Team {{name}}</h2>
                <p>Find us on table: {{table}}</p>
            {{/unless}}
            <div class="ui segment">
                Members: {{#each members}} <i class="user icon"></i> {{username}} {{/each}}
                <br>
                Hacks: {{#each hacks}} <i class="idea icon"></i> <a href="{{pathFor 'hack'}}">{{name}}</a> {{/each}}
            </div>
            {{#if ismyteam _id}}
                <div class="ui segment">
                    <form class="leave-team">
                        <p>Tired of this lot? Team letting you down? Got a better idea?</p>
                        <br>
                        <div class="field">
                            <button class="ui negative button" type="submit">Leave team</button>
                        </div>
                    </form>
                </div>
            {{/if}}
        </div>
    </div>
    {{/if}}
    {{/if}}
    {{#unless currentUser}}
    <div class="ui raised very padded text container segment">
        <h2>Want to be part of a hack?</h2>
        <p>You need to sign in or create an account to be part of a team.</p>
    </div>
    {{/unless}}
</template>

<template name="teamoverview">
    <div class="ui card">
        <div class="content">
            <div class="header">
                <i class="users icon"></i> Team {{name}}
            </div>
            <div class="meta">
                {{#each members}} <i class="user icon"></i> {{username}} {{/each}}
            </div>
            <div class="description">
                {{#each hacks}}
                    <i class="idea icon"></i> <a href="{{pathFor 'hack'}}">{{name}}</a> <br>
                {{/each}}
            </div>
        </div>
        <div class="extra content">
            <p>Find us on table: {{table}}</p>
        </div>
        {{#if currentUser}}
        {{#unless isJudge}}
        {{#unless isAdmin}}
        {{#unless currentUser/profile/team}}
        <div class="extra content">
            <form class="join-team">
                <button class="positive ui button" type="submit">Join this team</button>
            </form>
        </div>
        {{/unless}}
        {{/unless}}
        {{/unless}}
        {{/if}}
        <div class="ui bottom attached button">
            <a href="{{pathFor 'team' }}">View</a>
        </div>
    </div>
</template>

<template name="administration">
    <div class="ui raised very padded text container">
        <div class="ui segments">
            <div class="ui segment">
                <h2>Challenges</h2>
            </div>
            {{#each challenges}}
            <div class="ui segment secondary form">
                <form class="edit-challenge">
                    <div class="two fields">
                        <div class="field">
                            <input type="text" name="description" placeholder="A Challenge" value="{{description}}" />
                        </div>
                        <div class="field">
                            <button class="positive ui button" type="submit">Save</button>
                            <button class="negative ui button delete-challenge" type="button">Delete</button>
                        </div>
                    </div>
                </form>
            </div>
            {{/each}}
            <div class="ui segment form">
                <form class="new-challenge">
                    <div class="field">
                        <input type="text" name="challenge" placeholder="Add a new challenge ..." value="{{challenge}}" />
                    </div>
                    <button class="positive ui button" type="submit">Save</button>
                </form>
            </div>
        </div>
        <div class="ui segments">
            <div class="ui segment">
                <h2>Users</h2>
            </div>
        </div>
        <table class="ui celled table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Id</th>
                    <th>Judge</th>
                    <th>Admin</th>
                </tr>
            </thead>
            <tbody>
            {{#each users}}
                <tr>
                    <td>
                        {{username}}
                    </td>
                    <td>
                        {{_id}}
                    </td>
                    <td>
                        <input type="checkbox" checked="{{profile/isJudge}}" class="toggle-isjudge" />
                    </td>
                    <td>
                        <input type="checkbox" checked="{{profile/isAdmin}}" class="toggle-isadmin" />
                    </td>
                </tr>
            {{/each}}
            </tbody>
        </table>
        <div class="ui segments">
            <div class="ui segment">
                <h2>Tech</h2>
            </div>
            {{#each technologies}}
                <div class="ui segment secondary form">
                    <form class="edit-tech">
                        <div class="two fields">
                            <div class="field">
                                <input type="text" name="description" placeholder="Tech name ..." value="{{description}}" />
                            </div>
                            <div class="field">
                                <button class="positive ui button" type="submit">Save</button>
                                <button class="negative ui button delete-tech" type="button">Delete</button>
                            </div>
                        </div>
                    </form>
                </div>
            {{/each}}
            <div class="ui segment form">
                <form class="new-tech">
                    <div class="field">
                        <input type="text" name="tech" placeholder="Add a new tech ..." value="{{tech}}" />
                    </div>
                    <button class="positive ui button" type="submit">Save</button>
                </form>
            </div>
        </div>
    </div>
</template>

<template name="judging">
    {{#each challenges}}
        <div class="ui raised padded text container segment">
            <h2>{{description}}</h2>
        </div>
        <div class="ui container">
            <div class="ui three cards">
                {{#each hacks}}
                    {{> hackoverview }}
                {{/each}}
            </div>
        </div>
    {{/each}}

</template>
