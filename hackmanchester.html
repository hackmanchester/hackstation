<head>
  <title>hackmanchester</title>
</head>

<template name="layout">
    {{> navigation }}
    {{> yield}}
</template>

<template name="navigation">
    <div class="ui secondary pointing menu">
        <li class="item">{{> loginButtons}}</li>
        <a class="item {{isActive 'home'}}" href="{{pathFor route='home'}}">Home</a>
        <a class="item {{isActive 'hacks'}}" href="{{pathFor route='hacks'}}">All Hacks</a>
        {{#unless isJudge}}
        {{#if currentUser}}
        <a class="item {{isActive 'myhacks'}}" href="{{pathFor route='myhacks'}}">My Hacks</a>
        {{/if}}
        {{/unless}}
        <div class="right menu">
            {{#if isJudge}}
                <a class="item {{isActive 'judgingoverview'}}" href="{{pathFor route='judgingoverview'}}">Judging</a>
            {{/if}}
            {{#if isAdmin}}
                <a class="item {{isActive 'administration'}}" href="{{pathFor route='administration'}}">Admin</a>
            {{/if}}
        </div>
    </div>
</template>

<template name="home">
    <div class="ui raised very padded text container">
        <div class="ui segment">
            <h1 class="ui header">Welcome to HackManchester!</h1>
        </div>
        <div class="ui segment">
            <h2 class="ui header">Latest submissions:</h2>
        </div>
        {{#each hacks}}
            {{> hackoverview }}
        {{/each}}
    </div>
</template>

<template name="hacks">
    <div class="ui raised very padded text container segment">
        <h1>Hacks!</h1>
        <p>How are you and your competition doing?</p>
    </div>
    <div class="ui three column doubling grid container">
        {{#each hacks}}
            <div class="column">
                {{> hackoverview }}
            </div>
        {{/each}}
    </div>
    {{#unless isJudge}}
    <div class="ui raised very padded text container segment">
        <h2>Want to submit a new hack?</h2>
        {{#unless currentUser}}
            You are not currently logged in!
        {{/unless}}
        {{#if currentUser}}
            <form class="new-hack">
                {{> modifyEntry }}
            </form>
        {{/if}}
    </div>
    {{/unless}}
</template>

<template name="myhacks">
    <div class="ui raised very padded text container segment">
        <h1>Your Hacks!</h1>
    </div>
    <div class="ui three column doubling grid container">
        {{#each hacks}}
            <div class="column">
                {{> hackoverview }}
            </div>
        {{/each}}
    </div>
    <div class="ui raised very padded text container segment">
        <h2>Want to submit a new hack?</h2>
        {{#unless currentUser}}
            You are not currently logged in!
        {{/unless}}
        {{#if currentUser}}
            <form class="new-hack">
                {{> modifyEntry }}
            </form>
        {{/if}}
    </div>
</template>

<template name="hackoverview">
    <div class="ui segments">
        <div class="ui segment">
            {{name}}
        </div>
        <div class="ui secondary segment">
            {{team}}
        </div>
        <div class="ui secondary segment">
            {{trim250 description}}
            <p>
            {{#if myHack }}
                <a href="{{pathFor 'hack'}}">Edit</a>
            {{/if}}
            {{#unless myHack }}
                <a href="{{pathFor 'hack'}}">View</a>
            {{/unless}}
            </p>
        </div>
    </div>
</template>

<template name="hack">
    <div class="ui raised very padded text container">
    {{#unless myHack}}
        <div class="ui segments">
            <div class="ui segment">
                <h1>{{name}}</h1>
            </div>
            <div class="ui secondary segment">
                <h2>{{team}}</h2>
            </div>
            <div class="ui secondary segment">
                <p>{{description}}</p>
            </div>
        </div>
    {{/unless}}
    {{#if myHack}}
        <form class="edit-hack">
            {{> modifyEntry }}
        </form>
    {{/if}}
    {{#if isJudge}}
        <div class="ui segments">
            <div class="ui segment">
                <h2>Judges comments:</h2>
            </div>
            {{#unless judgesComments}}
            <div class="ui segment secondary">
                <p>No comments have been made yet!</p>
            </div>
            {{/unless}}
            {{#each judgesComments}}
                <div class="ui segment">
                    <div class="ui segment">
                        {{created}} <strong>{{judge}}</strong>
                    </div>
                    <div class="ui inverted segment">
                        {{judgement}}
                    </div>
                </div>
            {{/each}}
            <div class="ui segment form">
                <form class="new-judgement">
                    <div class="field">
                        <label for="judgement">Add a judgment:</label>
                        <input type="text" name="judgement" placeholder="Add a judgment ..." value="{{judgement}}" />
                    </div>
                    <button class="ui button" type="submit">Submit</button>
                </form>
            </div>
        </div>
    {{/if}}
    </div>
</template>

<template name="modifyEntry">
    <div class="ui form">
        <div class="two fields">
            <div class="field">
                <label for="team">Team:</label>
                <input type="text" name="team" placeholder="Team name ..." value="{{team}}" />
            </div>
            <div class="field">
                <label for="name">Name:</label>
                <input type="text" name="name" placeholder="Hack name ..." value="{{name}}" />
            </div>
        </div>
        <div class="field">
            <label for="description">Description:</label>
            <input type="text" name="description" placeholder="Description ..." value="{{description}}" />
        </div>
        <button class="ui button" type="submit">Save</button>
    </div>
</template>

<template name="administration">
    <div class="ui raised very padded text container">
        <div class="ui segments">
            <div class="ui segment">
                <h2>Users</h2>
            </div>
        </div>
        <table class="ui celled table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Judge</th>
                    <th>Admin</th>
                </tr>
            </thead>
            <tbody>
            {{#each users}}
                <tr>
                    <td>
                        {{profile/name}}
                        {{#if profile/name}}
                            (
                        {{/if}}
                        {{_id}}
                        {{#if profile/name}}
                            )
                        {{/if}}
                    </td>
                    <td>
                        <input type="checkbox" checked="{{profile/isJudge}}" class="toggle-isjudge" />
                    </td>
                    <td>
                        <input type="checkbox" checked="{{profile/isAdmin}}" class="toggle-isadmin" />
                    </td>
                </tr>
            {{/each}}
            </tbody>
        </table>
    </div>
</template>
